<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bocaditos</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />
  <script src="js/app.js" defer></script>
</head>
<body>
  <div class="page-wrap">
    <div class="panel">
      <div class="panel-inner">
        <aside class="usuario">
          <div class="user-box">
            <h2 class="user-title">Nombre de usuario</h2>
            <div class="user-top">
              <div class="avatar-wrap">
                <img src="assets/piña.png" alt="Avatar" class="avatar" />
              </div>
              <div class="status-group">
                <span class="status-placeholder" aria-hidden="true"></span>
                <button class="status-btn active"><span>Activo</span></button>
              </div>
            </div>
            <!-- Button to complete profile data (also available on this dashboard) -->
            <div style="text-align:center; margin-top:12px;">
              <button id="complete-data-btn" class="complete-btn">completa tus datos</button>
            </div>
            <div class="profile-box">
              <p><strong>Rol de usuario:</strong> <span id="role-value">Beneficiario</span></p>
              <p><strong>Carrera:</strong> <span id="carrera-value"></span></p>
            </div>
            <!-- Edit profile form (hidden by default) -->
            <div id="edit-profile-container" style="display:none;margin-top:12px;">
              <form id="edit-profile-form">
                <input id="edit-name" class="pill-input" name="nombre" type="text" placeholder="Nombre" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <input id="edit-apellido" class="pill-input" name="apellido" type="text" placeholder="Apellido" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <input id="edit-matricula" class="pill-input" name="matricula" type="text" placeholder="Matrícula" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <input id="edit-cuatrimestre" class="pill-input" name="cuatrimestre" type="text" placeholder="Cuatrimestre" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <input id="edit-carrera" class="pill-input" name="carrera" type="text" placeholder="Carrera" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <input id="edit-grupo" class="pill-input" name="grupo" type="text" placeholder="Grupo" style="margin-bottom:8px;width:100%;padding:8px;border-radius:6px;border:1px solid #e9cfcf;">
                <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
                  <button id="cancel-profile-btn" type="button" style="background:#fff3f3;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;">Cancelar</button>
                  <button id="save-profile-btn" type="submit" style="background:#2e8b57;color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;">Guardar</button>
                </div>
              </form>
            </div>
            <!-- Confirmation modal (shared) -->
            <div id="confirm-modal" class="modal-overlay" style="display:none;">
              <div class="modal">
                <div class="modal-body">
                  <p>¿Confirmas que deseas actualizar tus datos?</p>
                </div>
                <div class="modal-actions">
                  <button id="confirm-no" class="modal-btn modal-cancel">Cancelar</button>
                  <button id="confirm-yes" class="modal-btn modal-confirm">Confirmar</button>
                </div>
              </div>
            </div>
          </div>

            <div class="info-panel">
            <div class="info-title">Información del usuario</div>
            <p><strong>Matrícula:</strong> <span id="matricula-value"></span></p>
            <p><strong>Grupo:</strong> <span id="grupo-value"></span></p>
            <p><strong>Cuatrimestre:</strong> <span id="cuatrimestre-value"></span></p>
            <a class="btn-logout" href="login.html">Cerrar Sesión</a>
          </div>
        </aside>

        <main class="formulario">
          <div class="right-panel">
            <div class="panel-title">Panel</div>
            <div class="chip">Bienvenida</div>

            <div class="card">
              <div class="card-inner">
                <div class="card-row">
                  <img src="assets/alergia.jpg" alt="ilustracion" class="card-thumb">
                  <div class="card-text">
                    <h3>¿Alergia alimentaria?</h3>
                    <p class="muted">Indique si es alérgico a algún tipo de comida.</p>
                    <input type="text" class="input-like" placeholder="Ej: Nueces, mariscos, fresas...">
                    <div id="allergies-list" style="margin-top:8px; font-size:14px;"></div>
                  </div>
                  <div style="display:flex;flex-direction:column;gap:8px;align-items:center;">
                    <button class="guardar">Guardar</button>
                    <button id="delete-allergies-btn" class="btn" style="background:#fff3f3;color:#000;padding:6px 10px;border-radius:6px;border:1px solid #e9cfcf;">Eliminar alergias</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-inner">
                <div class="card-row">
                  <img src="assets/buzon.png" alt="mail" class="card-thumb">
                  <div class="card-text">
                    <h3>¿Comentarios o quejas?</h3>
                    <p class="muted">Comparte tus comentarios o quejas para mejorar nuestro servicio.</p>
                    <textarea class="input-like" placeholder="Escriba aquí sus comentarios"></textarea>
                  </div>
                  <button class="enviar">Enviar</button>
                </div>
              </div>
            </div>

          </div>
        </main>
      </div>
    </div>
  </div>
  <!-- Modal: delete allergies -->
  <div id="delete-allergies-modal" class="modal-overlay" style="display:none;">
    <div class="modal" style="max-width:520px;">
      <div class="modal-body">
        <h3>Eliminar alergias</h3>
        <p>Seleccione las alergias que desea eliminar:</p>
        <div id="delete-allergies-list" style="max-height:240px;overflow:auto;margin-top:8px;padding:6px 4px;"></div>
      </div>
      <div class="modal-actions">
        <button id="delete-allergies-cancel" class="modal-btn modal-cancel">Cancelar</button>
        <button id="delete-allergies-confirm" class="modal-btn modal-confirm">Eliminar seleccionadas</button>
      </div>
    </div>
  </div>
  <script>
    // Botón de retroceso: preferir history.back() cuando sea posible, usar login.html como alternativa// Botón de retroceso: preferir history.back() cuando sea posible, usar login.html como alternativa
    (function(){
      var back = document.querySelector('.btn-back');
      if (!back) return;
      back.addEventListener('click', function(e){
        // Si el referente es del mismo origen o el historial tiene entradas, regresar
        var canGoBack = (document.referrer && document.referrer.indexOf(location.hostname) !== -1) || history.length > 1;
        if (canGoBack) {
          e.preventDefault();
          history.back();
        }
        // de lo contrario permitir que el href del ancla navegue a login.html
      });
    })();
  </script>
</body>
</html>

